pipeline {

  agent any 

  stages {

    stage('Build') {
      steps {
        // Checkout code from Git repo
        checkout scm  

        // Print current working directory
        sh "pwd"

        // Build Docker image in the TIC directory
        sh "docker build -t radiagulzan/ticketlogging:latest -f TIC/Dockerfile ."
      }
    }

    stage('Deploy') {
       steps {
         // Stop any existing container
        
        sh "docker ps -q --filter 'name=ticketlogging-container' | grep -q . && docker stop ticketlogging-container"
        
         // Run Docker image
        sh "docker run --name ticketlogging-container -d radiagulzan/ticketlogging:latest"
       }
    }

  }

}